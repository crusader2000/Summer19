<!DOCTYPE html>
<html lang="en"><head>
		<title>
						Make your own blog
			&gt; Comment admin		</title>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

				            <link type="text/css" rel="stylesheet" href="Make%20your%20own%20blog%20%3E%20Comment%20admin_files/local-file.css">
		
				<style id="dynamic-styles">
			#content		{
							font-family: 'Open Sans', sans-serif;
			
							font-weight: 300;
					}
			#contents-menu		{
							font-family: 'Open Sans', sans-serif;
			
							font-weight: 300;
					}
			#contents-menu h2		{
			
							font-weight: 400;
					}
			#content h1		{
			
							font-weight: 300;
					}
			#content h2		{
			
							font-weight: 400;
					}
			.sidebar .heading p		{
			
							font-weight: 400;
					}
	</style>

				<script type="text/javascript" async="" defer="defer" src="Make%20your%20own%20blog%20%3E%20Comment%20admin_files/piwik.js"></script><script src="Make%20your%20own%20blog%20%3E%20Comment%20admin_files/compiled.js"></script>

				<link type="text/css" rel="stylesheet" href="Make%20your%20own%20blog%20%3E%20Comment%20admin_files/compiled.css">

	</head>
	<body>
		<div id="fixed-panel">
			<div id="version-chooser">
				<div class="inner">
					<p>
	Choose a version here. If you've not already started the tutorial, just go
	with the latest one.
</p>

<table>
	<tbody>
					<tr>
				<td>30 Aug 2014</td>
				<td>Preview version</td>
				<td>
					<a href="https://ilovephp.jondh.me.uk/en/tutorial/make-your-own-blog/comment-admin?version=v1">Choose</a>
									</td>
			</tr>
					<tr>
				<td>5 Oct 2014</td>
				<td>Explicitly adds a specific charset for htmlspecialchars(), and wraps it with a custom function</td>
				<td>
					<a href="https://ilovephp.jondh.me.uk/en/tutorial/make-your-own-blog/comment-admin?version=v2">Choose</a>
									</td>
			</tr>
					<tr>
				<td>16 Oct 2014</td>
				<td>Updated redirect function to work with vhost subfolders</td>
				<td>
					<a href="https://ilovephp.jondh.me.uk/en/tutorial/make-your-own-blog/comment-admin?version=v3">Choose</a>
									</td>
			</tr>
					<tr>
				<td>4 Nov 2014</td>
				<td>Minor improvements: added missing docblock, fixed security 
issue, CSS tweak. Switched hashing method to DEFAULT instead of BCRYPT, 
this is best practice.</td>
				<td>
					<a href="https://ilovephp.jondh.me.uk/en/tutorial/make-your-own-blog/comment-admin?version=v4">Choose</a>
									</td>
			</tr>
					<tr>
				<td>25 Nov 2014</td>
				<td>Improve the notes on getting started, in particular choosing a programmer's editor. Added introduction to mod_rewrite rules.</td>
				<td>
					<a href="https://ilovephp.jondh.me.uk/en/tutorial/make-your-own-blog/comment-admin?version=v5">Choose</a>
									</td>
			</tr>
					<tr>
				<td>16 Aug 2018</td>
				<td>Some bug fixes, remove compatibility library for earlier version of PHP</td>
				<td>
					<a href="https://ilovephp.jondh.me.uk/en/tutorial/make-your-own-blog/comment-admin?version=v6">Choose</a>
											♥
									</td>
			</tr>
			</tbody>
</table>				</div>
			</div>
			<div id="header">
				<div id="header-inner">
					<a href="https://ilovephp.jondh.me.uk/" title="Home">I ♥ PHP</a>




<a id="version-chooser-toggle" class="section" title="See the different available versions">
	Versions
</a>
				</div>
			</div>
		</div>

				<div id="hidden-padding"></div>

					<div id="versions-note">
		<span id="versions-note-close">
			OK
		</span>
		<div id="versions-note-inner">
			NB:
			There are several versions of this tutorial, each successive one
			containing additional improvements. If you're in the middle of
			working through it, please check the versions panel above, to
			ensure you're not mixing code from different versions.
		</div>
	</div>

							<div id="popup-sections">
				
<div id="contents-menu">
	<h2>Contents</h2>

			<div class="menu-entry unselected">
			<div class="title">
				1.

									<a href="https://ilovephp.jondh.me.uk/en/tutorial/make-your-own-blog/introduction">Introduction</a>
							</div>
					</div>
			<div class="menu-entry unselected">
			<div class="title">
				2.

									<a href="https://ilovephp.jondh.me.uk/en/tutorial/make-your-own-blog/using-real-data">Using real data</a>
							</div>
					</div>
			<div class="menu-entry unselected">
			<div class="title">
				3.

									<a href="https://ilovephp.jondh.me.uk/en/tutorial/make-your-own-blog/adding-more-features">Adding more features</a>
							</div>
					</div>
			<div class="menu-entry unselected">
			<div class="title">
				4.

									<a href="https://ilovephp.jondh.me.uk/en/tutorial/make-your-own-blog/improving-the-installer">Improving the installer</a>
							</div>
					</div>
			<div class="menu-entry unselected">
			<div class="title">
				5.

									<a href="https://ilovephp.jondh.me.uk/en/tutorial/make-your-own-blog/commenting-form">Commenting form</a>
							</div>
					</div>
			<div class="menu-entry unselected">
			<div class="title">
				6.

									<a href="https://ilovephp.jondh.me.uk/en/tutorial/make-your-own-blog/adding-a-login-system">Adding a login system</a>
							</div>
					</div>
			<div class="menu-entry unselected">
			<div class="title">
				7.

									<a href="https://ilovephp.jondh.me.uk/en/tutorial/make-your-own-blog/tidy-up">Tidy up</a>
							</div>
					</div>
			<div class="menu-entry unselected">
			<div class="title">
				8.

									<a href="https://ilovephp.jondh.me.uk/en/tutorial/make-your-own-blog/new-post-creation">New post creation</a>
							</div>
					</div>
			<div class="menu-entry unselected">
			<div class="title">
				9.

									<a href="https://ilovephp.jondh.me.uk/en/tutorial/make-your-own-blog/post-editing">Post editing</a>
							</div>
					</div>
			<div class="menu-entry unselected">
			<div class="title">
				10.

									<a href="https://ilovephp.jondh.me.uk/en/tutorial/make-your-own-blog/all-posts-page">All posts page</a>
							</div>
					</div>
			<div class="menu-entry selected">
			<div class="title">
				11.

														Comment admin							</div>
					</div>
			<div class="menu-entry unselected">
			<div class="title">
				12.

									<a href="https://ilovephp.jondh.me.uk/en/tutorial/make-your-own-blog/adding-some-polish">Adding some polish</a>
							</div>
					</div>
	</div>
							</div>

			<div id="content">
				<h1>Make your own blog</h1>

									

<h2>Comment admin</h2>

<p id="hash-871ac01874" class="commentable">
	In this section, we'll allow authorised users to delete comments from posts. To kick us
	off, here's a nice item of refactoring — the comments list within article pages is quite
	large, and it would be more modular to store it in a separate file.
</p>


<div class="tab-container" id="tab-container-c1d3dd0f16baf507abb098a972dcb8390b9b803c" data-easytabs="true">
	
			<img class="expand-toggle icon" src="Make%20your%20own%20blog%20%3E%20Comment%20admin_files/code-expand.png" alt="Expand/contract code area" style="display: none;">

		<img class="tabs-move-left tabs-move icon" src="Make%20your%20own%20blog%20%3E%20Comment%20admin_files/tab-left.png" alt="Select previous tab">

	<div class="tabs-chopper">

				<ul class="tabs">
							<li class="tab active">
										<a href="#tabs-182e5183fd5ff0e79f4e-0" class="active">templates/list-comments.php</a>

										<span class="active">templates/list-comments.php</span>
				</li>
							<li class="tab">
										<a href="#tabs-182e5183fd5ff0e79f4e-1">view-post.php</a>

										<span>view-post.php</span>
				</li>
					</ul>

	</div>

	<img class="tabs-move-right tabs-move icon" src="Make%20your%20own%20blog%20%3E%20Comment%20admin_files/tab-right.png" alt="Select next tab">

				<div id="tabs-182e5183fd5ff0e79f4e-0" class="insert-diff active" style="">
			<div class="top-bar">

				
				<div class="download-block">
					<span class="download">
						<a href="https://ilovephp.jondh.me.uk/checkouts/rebase5/182e5183fd5ff0e79f4e/templates/list-comments.php" target="_blank"><img src="Make%20your%20own%20blog%20%3E%20Comment%20admin_files/disk.png" alt="">
						Download</a>
					</span>
				</div>

			</div>
			<div class="diff-scroll contracted">
				<div class="diff-body">
					<div class="file full-width">
				<div class="right side">
			<div class="inner-side">
				
<div class="line-numbers">
			<div class="line-numbers-section ">
												<div class="line line-number-line">
						<code>1</code>
					</div>
																<div class="line line-number-line">
						<code>2</code>
					</div>
																<div class="line line-number-line">
						<code>3</code>
					</div>
																<div class="line line-number-line">
						<code>4</code>
					</div>
																<div class="line line-number-line">
						<code>5</code>
					</div>
																<div class="line line-number-line">
						<code>6</code>
					</div>
																<div class="line line-number-line">
						<code>7</code>
					</div>
																<div class="line line-number-line">
						<code>8</code>
					</div>
																<div class="line line-number-line">
						<code>9</code>
					</div>
																<div class="line line-number-line">
						<code>10</code>
					</div>
																<div class="line line-number-line">
						<code>11</code>
					</div>
																<div class="line line-number-line">
						<code>12</code>
					</div>
																<div class="line line-number-line">
						<code>13</code>
					</div>
																<div class="line line-number-line">
						<code>14</code>
					</div>
																<div class="line line-number-line">
						<code>15</code>
					</div>
																<div class="line line-number-line">
						<code>16</code>
					</div>
																<div class="line line-number-line">
						<code>17</code>
					</div>
																<div class="line line-number-line">
						<code>18</code>
					</div>
																<div class="line line-number-line">
						<code>19</code>
					</div>
																<div class="line line-number-line">
						<code>20</code>
					</div>
																<div class="line line-number-line">
						<code>21</code>
					</div>
																<div class="line line-number-line">
						<code>22</code>
					</div>
																<div class="line line-number-line">
						<code>23</code>
					</div>
																<div class="line line-number-line">
						<code>24</code>
					</div>
									</div>
	</div>
<div class="diff-content">
			<div class="section ">
												<div class="line diff-line diff-line-added">
						<code>&lt;?php</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>/**</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code> * @var $pdo PDO</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code> * @var $postId integer</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code> */</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>?&gt;</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&lt;div class="comment-list"&gt;</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;h3&gt;&lt;?php echo countCommentsForPost($pdo, $postId) ?&gt; comments&lt;/h3&gt;</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code></code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;?php foreach (getCommentsForPost($pdo, $postId) as $comment): ?&gt;</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div class="comment"&gt;</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div class="comment-meta"&gt;</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Comment from</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;?php echo htmlEscape($comment['name']) ?&gt;</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;on</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;?php echo convertSqlDate($comment['created_at']) ?&gt;</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div class="comment-body"&gt;</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;?php // This is already escaped ?&gt;</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;?php echo convertNewlinesToParagraphs($comment['text']) ?&gt;</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;?php endforeach ?&gt;</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&lt;/div&gt;</code>
					</div>
									</div>
	</div>
			</div>
		</div>
	</div>
				</div>
			</div>
		</div>
			<div id="tabs-182e5183fd5ff0e79f4e-1" class="insert-diff" style="display: none;">
			<div class="top-bar">

				
				<div class="download-block">
					<span class="download">
						<a href="https://ilovephp.jondh.me.uk/checkouts/rebase5/182e5183fd5ff0e79f4e/view-post.php" target="_blank"><img src="Make%20your%20own%20blog%20%3E%20Comment%20admin_files/disk.png" alt="">
						Download</a>
					</span>
				</div>

			</div>
			<div class="diff-scroll contracted">
				<div class="diff-body">
					<div class="file ">
			<div class="left side">
			<div class="inner-side">
				
<div class="line-numbers">
			<div class="line-numbers-section top-missing">
												<div class="line line-number-line">
						<code>79</code>
					</div>
																<div class="line line-number-line">
						<code>80</code>
					</div>
																<div class="line line-number-line">
						<code>81</code>
					</div>
																<div class="line line-number-line">
						<code>82</code>
					</div>
																<div class="line line-number-line">
						<code>83</code>
					</div>
																<div class="line line-number-line">
						<code>84</code>
					</div>
																<div class="line line-number-line">
						<code>85</code>
					</div>
																<div class="line line-number-line">
						<code>86</code>
					</div>
																<div class="line line-number-line">
						<code>87</code>
					</div>
																<div class="line line-number-line">
						<code>88</code>
					</div>
																<div class="line line-number-line">
						<code>89</code>
					</div>
																<div class="line line-number-line">
						<code>90</code>
					</div>
																<div class="line line-number-line">
						<code>91</code>
					</div>
																<div class="line line-number-line">
						<code>92</code>
					</div>
																<div class="line line-number-line">
						<code>93</code>
					</div>
																<div class="line line-number-line">
						<code>94</code>
					</div>
																<div class="line line-number-line">
						<code>95</code>
					</div>
																<div class="line line-number-line">
						<code>96</code>
					</div>
																<div class="line line-number-line">
						<code>97</code>
					</div>
																<div class="line line-number-line">
						<code>98</code>
					</div>
																<div class="line line-number-line">
						<code>99</code>
					</div>
																<div class="line line-number-line">
						<code>100</code>
					</div>
																<div class="line line-number-line">
						<code>101</code>
					</div>
																<div class="line line-number-line">
						<code>102</code>
					</div>
									</div>
	</div>
<div class="diff-content">
			<div class="section top-missing">
												<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;?php echo convertNewlinesToParagraphs($row['body']) ?&gt;</code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;</code>
					</div>
																<div class="line diff-line ">
						<code></code>
					</div>
																<div class="line diff-line diff-line-deleted">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div class="comment-list"&gt;</code>
					</div>
																<div class="line diff-line diff-line-deleted">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;h3&gt;&lt;?php echo countCommentsForPost($pdo, $postId) ?&gt; comments&lt;/h3&gt;</code>
					</div>
																<div class="line diff-line diff-line-deleted">
						<code></code>
					</div>
																<div class="line diff-line diff-line-deleted">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;?php foreach (getCommentsForPost($pdo, $postId) as $comment): ?&gt;</code>
					</div>
																<div class="line diff-line diff-line-deleted">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div class="comment"&gt;</code>
					</div>
																<div class="line diff-line diff-line-deleted">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div class="comment-meta"&gt;</code>
					</div>
																<div class="line diff-line diff-line-deleted">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Comment from</code>
					</div>
																<div class="line diff-line diff-line-deleted">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;?php echo htmlEscape($comment['name']) ?&gt;</code>
					</div>
																<div class="line diff-line diff-line-deleted">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;on</code>
					</div>
																<div class="line diff-line diff-line-deleted">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;?php echo convertSqlDate($comment['created_at']) ?&gt;</code>
					</div>
																<div class="line diff-line diff-line-deleted">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;</code>
					</div>
																<div class="line diff-line diff-line-deleted">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div class="comment-body"&gt;</code>
					</div>
																<div class="line diff-line diff-line-deleted">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;?php // This is already escaped ?&gt;</code>
					</div>
																<div class="line diff-line diff-line-deleted">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;?php echo convertNewlinesToParagraphs($comment['text']) ?&gt;</code>
					</div>
																<div class="line diff-line diff-line-deleted">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;</code>
					</div>
																<div class="line diff-line diff-line-deleted">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;</code>
					</div>
																<div class="line diff-line diff-line-deleted">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;?php endforeach ?&gt;</code>
					</div>
																<div class="line diff-line diff-line-deleted">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;</code>
					</div>
																<div class="line diff-line ">
						<code></code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;?php require 'templates/comment-form.php' ?&gt;</code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/body&gt;</code>
					</div>
									</div>
	</div>
			</div>
		</div>	
				<div class="right side">
			<div class="inner-side">
				
<div class="line-numbers">
			<div class="line-numbers-section top-missing">
												<div class="line line-number-line">
						<code>79</code>
					</div>
																<div class="line line-number-line">
						<code>80</code>
					</div>
																<div class="line line-number-line">
						<code>81</code>
					</div>
																<div class="line line-number-line">
						<code>82</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-line">
						<code>83</code>
					</div>
																<div class="line line-number-line">
						<code>84</code>
					</div>
																<div class="line line-number-line">
						<code>85</code>
					</div>
									</div>
	</div>
<div class="diff-content">
			<div class="section top-missing">
												<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;?php echo convertNewlinesToParagraphs($row['body']) ?&gt;</code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;</code>
					</div>
																<div class="line diff-line ">
						<code></code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;?php require 'templates/list-comments.php' ?&gt;</code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line ">
						<code></code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;?php require 'templates/comment-form.php' ?&gt;</code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/body&gt;</code>
					</div>
									</div>
	</div>
			</div>
		</div>
	</div>
				</div>
			</div>
		</div>
	</div>

<p id="hash-dff8784994" class="commentable">
	Let us now add a delete button next to comments on blog posts, for authorised users only. I've
	added a bit of extra CSS to get it to float to the right-hand side.
</p>


<div class="tab-container" id="tab-container-7d33dba212dcc8a58c75d5c5ef4edcedf1257654" data-easytabs="true">
	
			<img class="expand-toggle icon" src="Make%20your%20own%20blog%20%3E%20Comment%20admin_files/code-expand.png" alt="Expand/contract code area" style="display: none;">

		<img class="tabs-move-left tabs-move icon" src="Make%20your%20own%20blog%20%3E%20Comment%20admin_files/tab-left.png" alt="Select previous tab">

	<div class="tabs-chopper">

				<ul class="tabs">
							<li class="tab active">
										<a href="#tabs-a40fd94b41af624ebd61-0" class="active">assets/main.css</a>

										<span class="active">assets/main.css</span>
				</li>
							<li class="tab">
										<a href="#tabs-a40fd94b41af624ebd61-1">templates/list-comments.php</a>

										<span>templates/list-comments.php</span>
				</li>
					</ul>

	</div>

	<img class="tabs-move-right tabs-move icon" src="Make%20your%20own%20blog%20%3E%20Comment%20admin_files/tab-right.png" alt="Select next tab">

				<div id="tabs-a40fd94b41af624ebd61-0" class="insert-diff active" style="">
			<div class="top-bar">

				
				<div class="download-block">
					<span class="download">
						<a href="https://ilovephp.jondh.me.uk/checkouts/rebase5/a40fd94b41af624ebd61/assets/main.css" target="_blank"><img src="Make%20your%20own%20blog%20%3E%20Comment%20admin_files/disk.png" alt="">
						Download</a>
					</span>
				</div>

			</div>
			<div class="diff-scroll contracted">
				<div class="diff-body">
					<div class="file ">
			<div class="left side">
			<div class="inner-side">
				
<div class="line-numbers">
			<div class="line-numbers-section top-missing">
												<div class="line line-number-line">
						<code>69</code>
					</div>
																<div class="line line-number-line">
						<code>70</code>
					</div>
																<div class="line line-number-line">
						<code>71</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-line">
						<code>72</code>
					</div>
																<div class="line line-number-line">
						<code>73</code>
					</div>
																<div class="line line-number-line">
						<code>74</code>
					</div>
									</div>
			<div class="line-numbers-section ">
												<div class="line line-number-line">
						<code>80</code>
					</div>
																<div class="line line-number-line">
						<code>81</code>
					</div>
																<div class="line line-number-line">
						<code>82</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-line">
						<code>83</code>
					</div>
																<div class="line line-number-line">
						<code>84</code>
					</div>
																<div class="line line-number-line">
						<code>85</code>
					</div>
									</div>
	</div>
<div class="diff-content">
			<div class="section top-missing">
												<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;padding-top: 8px;</code>
					</div>
																<div class="line diff-line ">
						<code>}</code>
					</div>
																<div class="line diff-line ">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line ">
						<code>.comment-body p {</code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;margin: 8px 4px;</code>
					</div>
																<div class="line diff-line ">
						<code>}</code>
					</div>
									</div>
			<div class="section ">
												<div class="line diff-line ">
						<code>.comment-list {</code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;border-bottom: 1px dotted silver;</code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;margin-bottom: 12px;</code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line ">
						<code>}</code>
					</div>
																<div class="line diff-line ">
						<code></code>
					</div>
																<div class="line diff-line ">
						<code>.comment-margin {</code>
					</div>
									</div>
	</div>
			</div>
		</div>	
				<div class="right side">
			<div class="inner-side">
				
<div class="line-numbers">
			<div class="line-numbers-section top-missing">
												<div class="line line-number-line">
						<code>69</code>
					</div>
																<div class="line line-number-line">
						<code>70</code>
					</div>
																<div class="line line-number-line">
						<code>71</code>
					</div>
																<div class="line line-number-line">
						<code>72</code>
					</div>
																<div class="line line-number-line">
						<code>73</code>
					</div>
																<div class="line line-number-line">
						<code>74</code>
					</div>
																<div class="line line-number-line">
						<code>75</code>
					</div>
																<div class="line line-number-line">
						<code>76</code>
					</div>
																<div class="line line-number-line">
						<code>77</code>
					</div>
																<div class="line line-number-line">
						<code>78</code>
					</div>
									</div>
			<div class="line-numbers-section ">
												<div class="line line-number-line">
						<code>80</code>
					</div>
																<div class="line line-number-line">
						<code>81</code>
					</div>
																<div class="line line-number-line">
						<code>82</code>
					</div>
																<div class="line line-number-line">
						<code>83</code>
					</div>
																<div class="line line-number-line">
						<code>84</code>
					</div>
																<div class="line line-number-line">
						<code>85</code>
					</div>
																<div class="line line-number-line">
						<code>86</code>
					</div>
									</div>
	</div>
<div class="diff-content">
			<div class="section top-missing">
												<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;padding-top: 8px;</code>
					</div>
																<div class="line diff-line ">
						<code>}</code>
					</div>
																<div class="line diff-line ">
						<code></code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>.comment .comment-meta input {</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;float: right;</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>}</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code></code>
					</div>
																<div class="line diff-line ">
						<code>.comment-body p {</code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;margin: 8px 4px;</code>
					</div>
																<div class="line diff-line ">
						<code>}</code>
					</div>
									</div>
			<div class="section ">
												<div class="line diff-line ">
						<code>.comment-list {</code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;border-bottom: 1px dotted silver;</code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;margin-bottom: 12px;</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;max-width: 900px;</code>
					</div>
																<div class="line diff-line ">
						<code>}</code>
					</div>
																<div class="line diff-line ">
						<code></code>
					</div>
																<div class="line diff-line ">
						<code>.comment-margin {</code>
					</div>
									</div>
	</div>
			</div>
		</div>
	</div>
				</div>
			</div>
		</div>
			<div id="tabs-a40fd94b41af624ebd61-1" class="insert-diff" style="display: none;">
			<div class="top-bar">

				
				<div class="download-block">
					<span class="download">
						<a href="https://ilovephp.jondh.me.uk/checkouts/rebase5/a40fd94b41af624ebd61/templates/list-comments.php" target="_blank"><img src="Make%20your%20own%20blog%20%3E%20Comment%20admin_files/disk.png" alt="">
						Download</a>
					</span>
				</div>

			</div>
			<div class="diff-scroll contracted">
				<div class="diff-body">
					<div class="file ">
			<div class="left side">
			<div class="inner-side">
				
<div class="line-numbers">
			<div class="line-numbers-section top-missing">
												<div class="line line-number-line">
						<code>14</code>
					</div>
																<div class="line line-number-line">
						<code>15</code>
					</div>
																<div class="line line-number-line">
						<code>16</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-line">
						<code>17</code>
					</div>
																<div class="line line-number-line">
						<code>18</code>
					</div>
																<div class="line line-number-line">
						<code>19</code>
					</div>
									</div>
	</div>
<div class="diff-content">
			<div class="section top-missing">
												<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;?php echo htmlEscape($comment['name']) ?&gt;</code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;on</code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;?php echo convertSqlDate($comment['created_at']) ?&gt;</code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;</code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div class="comment-body"&gt;</code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;?php // This is already escaped ?&gt;</code>
					</div>
									</div>
	</div>
			</div>
		</div>	
				<div class="right side">
			<div class="inner-side">
				
<div class="line-numbers">
			<div class="line-numbers-section top-missing">
												<div class="line line-number-line">
						<code>14</code>
					</div>
																<div class="line line-number-line">
						<code>15</code>
					</div>
																<div class="line line-number-line">
						<code>16</code>
					</div>
																<div class="line line-number-line">
						<code>17</code>
					</div>
																<div class="line line-number-line">
						<code>18</code>
					</div>
																<div class="line line-number-line">
						<code>19</code>
					</div>
																<div class="line line-number-line">
						<code>20</code>
					</div>
																<div class="line line-number-line">
						<code>21</code>
					</div>
																<div class="line line-number-line">
						<code>22</code>
					</div>
																<div class="line line-number-line">
						<code>23</code>
					</div>
																<div class="line line-number-line">
						<code>24</code>
					</div>
																<div class="line line-number-line">
						<code>25</code>
					</div>
																<div class="line line-number-line">
						<code>26</code>
					</div>
									</div>
	</div>
<div class="diff-content">
			<div class="section top-missing">
												<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;?php echo htmlEscape($comment['name']) ?&gt;</code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;on</code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;?php echo convertSqlDate($comment['created_at']) ?&gt;</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;?php if (isLoggedIn()): ?&gt;</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type="submit"</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name="delete-comment[&lt;?php echo $comment['id'] ?&gt;]"</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value="Delete"</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/&gt;</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;?php endif ?&gt;</code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;</code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div class="comment-body"&gt;</code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;?php // This is already escaped ?&gt;</code>
					</div>
									</div>
	</div>
			</div>
		</div>
	</div>
				</div>
			</div>
		</div>
	</div>

<p id="hash-270b1a6bd2" class="commentable">
	Since we want to do more than one thing with comments (add and delete), we need to
	make a change to explain what we are doing within the form submission. To do this, I've used
	the query string, which sends these items of information:
</p>

<ul id="hash-df79797c41" class="commentable">
	<li>The primary key of the post (<code class="inline">post_id</code>) upon which a comment is being added or
		deleted</li>
	<li>A name for the action (<code class="inline">add-comment</code> and <code class="inline">delete-comment</code>), which
		can be read by our code to determine what the user wishes to do</li>
</ul>


<div class="tab-container" id="tab-container-840db67dae4fcaf75970ca70fcbb900b47a4ea68" data-easytabs="true">
	
			<img class="expand-toggle icon" src="Make%20your%20own%20blog%20%3E%20Comment%20admin_files/code-expand.png" alt="Expand/contract code area" style="display: none;">

		<img class="tabs-move-left tabs-move icon" src="Make%20your%20own%20blog%20%3E%20Comment%20admin_files/tab-left.png" alt="Select previous tab">

	<div class="tabs-chopper">

				<ul class="tabs">
							<li class="tab active">
										<a href="#tabs-c62ba588ac2458605688-0" class="active">templates/comment-form.php</a>

										<span class="active">templates/comment-form.php</span>
				</li>
							<li class="tab">
										<a href="#tabs-c62ba588ac2458605688-1">templates/list-comments.php</a>

										<span>templates/list-comments.php</span>
				</li>
					</ul>

	</div>

	<img class="tabs-move-right tabs-move icon" src="Make%20your%20own%20blog%20%3E%20Comment%20admin_files/tab-right.png" alt="Select next tab">

				<div id="tabs-c62ba588ac2458605688-0" class="insert-diff active" style="">
			<div class="top-bar">

				
				<div class="download-block">
					<span class="download">
						<a href="https://ilovephp.jondh.me.uk/checkouts/rebase5/c62ba588ac2458605688/templates/comment-form.php" target="_blank"><img src="Make%20your%20own%20blog%20%3E%20Comment%20admin_files/disk.png" alt="">
						Download</a>
					</span>
				</div>

			</div>
			<div class="diff-scroll contracted">
				<div class="diff-body">
					<div class="file ">
			<div class="left side">
			<div class="inner-side">
				
<div class="line-numbers">
			<div class="line-numbers-section top-missing">
												<div class="line line-number-line">
						<code>18</code>
					</div>
																<div class="line line-number-line">
						<code>19</code>
					</div>
																<div class="line line-number-line">
						<code>20</code>
					</div>
																<div class="line line-number-line">
						<code>21</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-line">
						<code>22</code>
					</div>
																<div class="line line-number-line">
						<code>23</code>
					</div>
																<div class="line line-number-line">
						<code>24</code>
					</div>
									</div>
	</div>
<div class="diff-content">
			<div class="section top-missing">
												<div class="line diff-line ">
						<code></code>
					</div>
																<div class="line diff-line ">
						<code>&lt;h3&gt;Add your comment&lt;/h3&gt;</code>
					</div>
																<div class="line diff-line ">
						<code></code>
					</div>
																<div class="line diff-line diff-line-deleted">
						<code>&lt;form method="post" class="comment-form user-form"&gt;</code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;</code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;label for="comment-name"&gt;</code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Name:</code>
					</div>
									</div>
	</div>
			</div>
		</div>	
				<div class="right side">
			<div class="inner-side">
				
<div class="line-numbers">
			<div class="line-numbers-section top-missing">
												<div class="line line-number-line">
						<code>18</code>
					</div>
																<div class="line line-number-line">
						<code>19</code>
					</div>
																<div class="line line-number-line">
						<code>20</code>
					</div>
																<div class="line line-number-line">
						<code>21</code>
					</div>
																<div class="line line-number-line">
						<code>22</code>
					</div>
																<div class="line line-number-line">
						<code>23</code>
					</div>
																<div class="line line-number-line">
						<code>24</code>
					</div>
																<div class="line line-number-line">
						<code>25</code>
					</div>
																<div class="line line-number-line">
						<code>26</code>
					</div>
																<div class="line line-number-line">
						<code>27</code>
					</div>
																<div class="line line-number-line">
						<code>28</code>
					</div>
									</div>
	</div>
<div class="diff-content">
			<div class="section top-missing">
												<div class="line diff-line ">
						<code></code>
					</div>
																<div class="line diff-line ">
						<code>&lt;h3&gt;Add your comment&lt;/h3&gt;</code>
					</div>
																<div class="line diff-line ">
						<code></code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&lt;form</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;action="view-post.php?action=add-comment&amp;amp;post_id=&lt;?php echo $postId?&gt;"</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;method="post"</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;class="comment-form user-form"</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&gt;</code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;</code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;label for="comment-name"&gt;</code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Name:</code>
					</div>
									</div>
	</div>
			</div>
		</div>
	</div>
				</div>
			</div>
		</div>
			<div id="tabs-c62ba588ac2458605688-1" class="insert-diff" style="display: none;">
			<div class="top-bar">

				
				<div class="download-block">
					<span class="download">
						<a href="https://ilovephp.jondh.me.uk/checkouts/rebase5/c62ba588ac2458605688/templates/list-comments.php" target="_blank"><img src="Make%20your%20own%20blog%20%3E%20Comment%20admin_files/disk.png" alt="">
						Download</a>
					</span>
				</div>

			</div>
			<div class="diff-scroll contracted">
				<div class="diff-body">
					<div class="file ">
			<div class="left side">
			<div class="inner-side">
				
<div class="line-numbers">
			<div class="line-numbers-section top-missing">
												<div class="line line-number-line">
						<code>4</code>
					</div>
																<div class="line line-number-line">
						<code>5</code>
					</div>
																<div class="line line-number-line">
						<code>6</code>
					</div>
																<div class="line line-number-line">
						<code>7</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-line">
						<code>8</code>
					</div>
																<div class="line line-number-line">
						<code>9</code>
					</div>
																<div class="line line-number-line">
						<code>10</code>
					</div>
									</div>
			<div class="line-numbers-section ">
												<div class="line line-number-line">
						<code>32</code>
					</div>
																<div class="line line-number-line">
						<code>33</code>
					</div>
																<div class="line line-number-line">
						<code>34</code>
					</div>
																<div class="line line-number-line">
						<code>35</code>
					</div>
									</div>
	</div>
<div class="diff-content">
			<div class="section top-missing">
												<div class="line diff-line ">
						<code> * @var $postId integer</code>
					</div>
																<div class="line diff-line ">
						<code> */</code>
					</div>
																<div class="line diff-line ">
						<code>?&gt;</code>
					</div>
																<div class="line diff-line diff-line-deleted">
						<code>&lt;div class="comment-list"&gt;</code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;h3&gt;&lt;?php echo countCommentsForPost($pdo, $postId) ?&gt; comments&lt;/h3&gt;</code>
					</div>
																<div class="line diff-line ">
						<code></code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;?php foreach (getCommentsForPost($pdo, $postId) as $comment): ?&gt;</code>
					</div>
									</div>
			<div class="section ">
												<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;</code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;</code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;?php endforeach ?&gt;</code>
					</div>
																<div class="line diff-line diff-line-deleted">
						<code>&lt;/div&gt;</code>
					</div>
									</div>
	</div>
			</div>
		</div>	
				<div class="right side">
			<div class="inner-side">
				
<div class="line-numbers">
			<div class="line-numbers-section top-missing">
												<div class="line line-number-line">
						<code>4</code>
					</div>
																<div class="line line-number-line">
						<code>5</code>
					</div>
																<div class="line line-number-line">
						<code>6</code>
					</div>
																<div class="line line-number-line">
						<code>7</code>
					</div>
																<div class="line line-number-line">
						<code>8</code>
					</div>
																<div class="line line-number-line">
						<code>9</code>
					</div>
																<div class="line line-number-line">
						<code>10</code>
					</div>
																<div class="line line-number-line">
						<code>11</code>
					</div>
																<div class="line line-number-line">
						<code>12</code>
					</div>
																<div class="line line-number-line">
						<code>13</code>
					</div>
																<div class="line line-number-line">
						<code>14</code>
					</div>
									</div>
			<div class="line-numbers-section ">
												<div class="line line-number-line">
						<code>32</code>
					</div>
																<div class="line line-number-line">
						<code>33</code>
					</div>
																<div class="line line-number-line">
						<code>34</code>
					</div>
																<div class="line line-number-line">
						<code>35</code>
					</div>
									</div>
	</div>
<div class="diff-content">
			<div class="section top-missing">
												<div class="line diff-line ">
						<code> * @var $postId integer</code>
					</div>
																<div class="line diff-line ">
						<code> */</code>
					</div>
																<div class="line diff-line ">
						<code>?&gt;</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&lt;form</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;action="view-post.php?action=delete-comment&amp;amp;post_id=&lt;?php echo $postId?&gt;&amp;amp;"</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;method="post"</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;class="comment-list"</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&gt;</code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;h3&gt;&lt;?php echo countCommentsForPost($pdo, $postId) ?&gt; comments&lt;/h3&gt;</code>
					</div>
																<div class="line diff-line ">
						<code></code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;?php foreach (getCommentsForPost($pdo, $postId) as $comment): ?&gt;</code>
					</div>
									</div>
			<div class="section ">
												<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;</code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;</code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;?php endforeach ?&gt;</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&lt;/form&gt;</code>
					</div>
									</div>
	</div>
			</div>
		</div>
	</div>
				</div>
			</div>
		</div>
	</div>


<p id="hash-a84718b209" class="commentable">
	Let us now make some room in our view post page, by moving some logic to a new function.
</p>


<div class="tab-container" id="tab-container-4e53f242c140aa6fcb1cc4c08cda2c14b1c258f2" data-easytabs="true">
	
			<img class="expand-toggle icon" src="Make%20your%20own%20blog%20%3E%20Comment%20admin_files/code-expand.png" alt="Expand/contract code area">

		<img class="tabs-move-left tabs-move icon" src="Make%20your%20own%20blog%20%3E%20Comment%20admin_files/tab-left.png" alt="Select previous tab">

	<div class="tabs-chopper">

				<ul class="tabs">
							<li class="tab active">
										<a href="#tabs-37db044d0b69a45882d0-0" class="active">lib/view-post.php</a>

										<span class="active">lib/view-post.php</span>
				</li>
							<li class="tab">
										<a href="#tabs-37db044d0b69a45882d0-1">view-post.php</a>

										<span>view-post.php</span>
				</li>
					</ul>

	</div>

	<img class="tabs-move-right tabs-move icon" src="Make%20your%20own%20blog%20%3E%20Comment%20admin_files/tab-right.png" alt="Select next tab">

				<div id="tabs-37db044d0b69a45882d0-0" class="insert-diff active" style="">
			<div class="top-bar">

				
				<div class="download-block">
					<span class="download">
						<a href="https://ilovephp.jondh.me.uk/checkouts/rebase5/37db044d0b69a45882d0/lib/view-post.php" target="_blank"><img src="Make%20your%20own%20blog%20%3E%20Comment%20admin_files/disk.png" alt="">
						Download</a>
					</span>
				</div>

			</div>
			<div class="diff-scroll contracted">
				<div class="diff-body">
					<div class="file ">
			<div class="left side">
			<div class="inner-side">
				
<div class="line-numbers">
			<div class="line-numbers-section ">
												<div class="line line-number-line">
						<code>1</code>
					</div>
																<div class="line line-number-line">
						<code>2</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-line">
						<code>3</code>
					</div>
																<div class="line line-number-line">
						<code>4</code>
					</div>
																<div class="line line-number-line">
						<code>5</code>
					</div>
									</div>
	</div>
<div class="diff-content">
			<div class="section ">
												<div class="line diff-line ">
						<code>&lt;?php</code>
					</div>
																<div class="line diff-line ">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line ">
						<code>/**</code>
					</div>
																<div class="line diff-line ">
						<code> * Retrieves a single post</code>
					</div>
																<div class="line diff-line ">
						<code> *</code>
					</div>
									</div>
	</div>
			</div>
		</div>	
				<div class="right side">
			<div class="inner-side">
				
<div class="line-numbers">
			<div class="line-numbers-section ">
												<div class="line line-number-line">
						<code>1</code>
					</div>
																<div class="line line-number-line">
						<code>2</code>
					</div>
																<div class="line line-number-line">
						<code>3</code>
					</div>
																<div class="line line-number-line">
						<code>4</code>
					</div>
																<div class="line line-number-line">
						<code>5</code>
					</div>
																<div class="line line-number-line">
						<code>6</code>
					</div>
																<div class="line line-number-line">
						<code>7</code>
					</div>
																<div class="line line-number-line">
						<code>8</code>
					</div>
																<div class="line line-number-line">
						<code>9</code>
					</div>
																<div class="line line-number-line">
						<code>10</code>
					</div>
																<div class="line line-number-line">
						<code>11</code>
					</div>
																<div class="line line-number-line">
						<code>12</code>
					</div>
																<div class="line line-number-line">
						<code>13</code>
					</div>
																<div class="line line-number-line">
						<code>14</code>
					</div>
																<div class="line line-number-line">
						<code>15</code>
					</div>
																<div class="line line-number-line">
						<code>16</code>
					</div>
																<div class="line line-number-line">
						<code>17</code>
					</div>
																<div class="line line-number-line">
						<code>18</code>
					</div>
																<div class="line line-number-line">
						<code>19</code>
					</div>
																<div class="line line-number-line">
						<code>20</code>
					</div>
																<div class="line line-number-line">
						<code>21</code>
					</div>
																<div class="line line-number-line">
						<code>22</code>
					</div>
																<div class="line line-number-line">
						<code>23</code>
					</div>
																<div class="line line-number-line">
						<code>24</code>
					</div>
																<div class="line line-number-line">
						<code>25</code>
					</div>
																<div class="line line-number-line">
						<code>26</code>
					</div>
																<div class="line line-number-line">
						<code>27</code>
					</div>
																<div class="line line-number-line">
						<code>28</code>
					</div>
																<div class="line line-number-line">
						<code>29</code>
					</div>
									</div>
	</div>
<div class="diff-content">
			<div class="section ">
												<div class="line diff-line ">
						<code>&lt;?php</code>
					</div>
																<div class="line diff-line ">
						<code></code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>/**</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code> * Called to handle the comment form, redirects upon success</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code> *</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code> * @param PDO $pdo</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code> * @param integer $postId</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code> * @param array $commentData</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code> */</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>function handleAddComment(PDO $pdo, $postId, array $commentData)</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>{</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;$errors = addCommentToPost(</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pdo,</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$postId,</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$commentData</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;);</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code></code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;// If there are no errors, redirect back to self and redisplay</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;if (!$errors)</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;{</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;redirectAndExit('view-post.php?post_id=' . $postId);</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;}</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code></code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;return $errors;</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>}</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code></code>
					</div>
																<div class="line diff-line ">
						<code>/**</code>
					</div>
																<div class="line diff-line ">
						<code> * Retrieves a single post</code>
					</div>
																<div class="line diff-line ">
						<code> *</code>
					</div>
									</div>
	</div>
			</div>
		</div>
	</div>
				</div>
			</div>
		</div>
			<div id="tabs-37db044d0b69a45882d0-1" class="insert-diff" style="display: none;">
			<div class="top-bar">

				
				<div class="download-block">
					<span class="download">
						<a href="https://ilovephp.jondh.me.uk/checkouts/rebase5/37db044d0b69a45882d0/view-post.php" target="_blank"><img src="Make%20your%20own%20blog%20%3E%20Comment%20admin_files/disk.png" alt="">
						Download</a>
					</span>
				</div>

			</div>
			<div class="diff-scroll contracted">
				<div class="diff-body">
					<div class="file ">
			<div class="left side">
			<div class="inner-side">
				
<div class="line-numbers">
			<div class="line-numbers-section top-missing">
												<div class="line line-number-line">
						<code>33</code>
					</div>
																<div class="line line-number-line">
						<code>34</code>
					</div>
																<div class="line line-number-line">
						<code>35</code>
					</div>
																<div class="line line-number-line">
						<code>36</code>
					</div>
																<div class="line line-number-line">
						<code>37</code>
					</div>
																<div class="line line-number-line">
						<code>38</code>
					</div>
																<div class="line line-number-line">
						<code>39</code>
					</div>
																<div class="line line-number-line">
						<code>40</code>
					</div>
																<div class="line line-number-line">
						<code>41</code>
					</div>
																<div class="line line-number-line">
						<code>42</code>
					</div>
																<div class="line line-number-line">
						<code>43</code>
					</div>
																<div class="line line-number-line">
						<code>44</code>
					</div>
																<div class="line line-number-line">
						<code>45</code>
					</div>
																<div class="line line-number-line">
						<code>46</code>
					</div>
																<div class="line line-number-line">
						<code>47</code>
					</div>
																<div class="line line-number-line">
						<code>48</code>
					</div>
																<div class="line line-number-line">
						<code>49</code>
					</div>
									</div>
			<div class="line-numbers-section ">
												<div class="line line-number-line">
						<code>71</code>
					</div>
																<div class="line line-number-line">
						<code>72</code>
					</div>
																<div class="line line-number-line">
						<code>73</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-line">
						<code>74</code>
					</div>
																<div class="line line-number-line">
						<code>75</code>
					</div>
																<div class="line line-number-line">
						<code>76</code>
					</div>
									</div>
	</div>
<div class="diff-content">
			<div class="section top-missing">
												<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'website' =&gt; $_POST['comment-website'],</code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'text' =&gt; $_POST['comment-text'],</code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;);</code>
					</div>
																<div class="line diff-line diff-line-deleted">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;$errors = addCommentToPost(</code>
					</div>
																<div class="line diff-line diff-line-deleted">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pdo,</code>
					</div>
																<div class="line diff-line diff-line-deleted">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$postId,</code>
					</div>
																<div class="line diff-line diff-line-deleted">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$commentData</code>
					</div>
																<div class="line diff-line diff-line-deleted">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;);</code>
					</div>
																<div class="line diff-line diff-line-deleted">
						<code></code>
					</div>
																<div class="line diff-line diff-line-deleted">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;// If there are no errors, redirect back to self and redisplay</code>
					</div>
																<div class="line diff-line diff-line-deleted">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;if (!$errors)</code>
					</div>
																<div class="line diff-line diff-line-deleted">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;{</code>
					</div>
																<div class="line diff-line diff-line-deleted">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;redirectAndExit('view-post.php?post_id=' . $postId);</code>
					</div>
																<div class="line diff-line diff-line-deleted">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;}</code>
					</div>
																<div class="line diff-line ">
						<code>}</code>
					</div>
																<div class="line diff-line ">
						<code>else</code>
					</div>
																<div class="line diff-line ">
						<code>{</code>
					</div>
									</div>
			<div class="section ">
												<div class="line diff-line ">
						<code></code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;?php require 'templates/list-comments.php' ?&gt;</code>
					</div>
																<div class="line diff-line ">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;?php require 'templates/comment-form.php' ?&gt;</code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/body&gt;</code>
					</div>
																<div class="line diff-line ">
						<code>&lt;/html&gt;</code>
					</div>
									</div>
	</div>
			</div>
		</div>	
				<div class="right side">
			<div class="inner-side">
				
<div class="line-numbers">
			<div class="line-numbers-section top-missing">
												<div class="line line-number-line">
						<code>33</code>
					</div>
																<div class="line line-number-line">
						<code>34</code>
					</div>
																<div class="line line-number-line">
						<code>35</code>
					</div>
																<div class="line line-number-line">
						<code>36</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-line">
						<code>37</code>
					</div>
																<div class="line line-number-line">
						<code>38</code>
					</div>
																<div class="line line-number-line">
						<code>39</code>
					</div>
									</div>
			<div class="line-numbers-section ">
												<div class="line line-number-line">
						<code>71</code>
					</div>
																<div class="line line-number-line">
						<code>72</code>
					</div>
																<div class="line line-number-line">
						<code>73</code>
					</div>
																<div class="line line-number-line">
						<code>74</code>
					</div>
																<div class="line line-number-line">
						<code>75</code>
					</div>
																<div class="line line-number-line">
						<code>76</code>
					</div>
																<div class="line line-number-line">
						<code>77</code>
					</div>
									</div>
	</div>
<div class="diff-content">
			<div class="section top-missing">
												<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'website' =&gt; $_POST['comment-website'],</code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'text' =&gt; $_POST['comment-text'],</code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;);</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;$errors = handleAddComment($pdo, $postId, $commentData);</code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line ">
						<code>}</code>
					</div>
																<div class="line diff-line ">
						<code>else</code>
					</div>
																<div class="line diff-line ">
						<code>{</code>
					</div>
									</div>
			<div class="section ">
												<div class="line diff-line ">
						<code></code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;?php require 'templates/list-comments.php' ?&gt;</code>
					</div>
																<div class="line diff-line ">
						<code></code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;?php // We use $commentData in this HTML fragment ?&gt;</code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;?php require 'templates/comment-form.php' ?&gt;</code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/body&gt;</code>
					</div>
																<div class="line diff-line ">
						<code>&lt;/html&gt;</code>
					</div>
									</div>
	</div>
			</div>
		</div>
	</div>
				</div>
			</div>
		</div>
	</div>

<p id="hash-e80bec847e" class="commentable">
	We now need to read the action key we set up, so we can decide what feature to call.
	If the user is deleting a comment, the new function <code class="inline">deleteComment</code> in the next set
	of changes is called; although we could just delete by <code class="inline">comment.id</code>, to be sure of
	deleting the right thing we filter additionally by <code class="inline">comment.post_id</code>.
</p>

<p id="hash-bf00fe52d6" class="commentable">
	Note that we also add an <code class="inline">if()</code> clause to ensure that the delete operation is skipped if
	the user is not logged in. Although we do not render delete buttons for anonymous users, it is
	still possible for security crackers to fake a form submission that contains a valid deletion
	request — this clause prevents that.
</p>


<div class="tab-container" id="tab-container-bcb8f4261e06d84e81dd3727f89aa3a3d8806cf6" data-easytabs="true">
	
			<img class="expand-toggle icon" src="Make%20your%20own%20blog%20%3E%20Comment%20admin_files/code-expand.png" alt="Expand/contract code area">

		<img class="tabs-move-left tabs-move icon" src="Make%20your%20own%20blog%20%3E%20Comment%20admin_files/tab-left.png" alt="Select previous tab">

	<div class="tabs-chopper">

				<ul class="tabs">
							<li class="tab active">
										<a href="#tabs-a2fc91df29580763cd13-0" class="active">lib/view-post.php</a>

										<span class="active">lib/view-post.php</span>
				</li>
							<li class="tab">
										<a href="#tabs-a2fc91df29580763cd13-1">view-post.php</a>

										<span>view-post.php</span>
				</li>
					</ul>

	</div>

	<img class="tabs-move-right tabs-move icon" src="Make%20your%20own%20blog%20%3E%20Comment%20admin_files/tab-right.png" alt="Select next tab">

				<div id="tabs-a2fc91df29580763cd13-0" class="insert-diff active" style="">
			<div class="top-bar">

				
				<div class="download-block">
					<span class="download">
						<a href="https://ilovephp.jondh.me.uk/checkouts/rebase5/a2fc91df29580763cd13/lib/view-post.php" target="_blank"><img src="Make%20your%20own%20blog%20%3E%20Comment%20admin_files/disk.png" alt="">
						Download</a>
					</span>
				</div>

			</div>
			<div class="diff-scroll contracted">
				<div class="diff-body">
					<div class="file ">
			<div class="left side">
			<div class="inner-side">
				
<div class="line-numbers">
			<div class="line-numbers-section top-missing">
												<div class="line line-number-line">
						<code>24</code>
					</div>
																<div class="line line-number-line">
						<code>25</code>
					</div>
																<div class="line line-number-line">
						<code>26</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-line">
						<code>27</code>
					</div>
																<div class="line line-number-line">
						<code>28</code>
					</div>
																<div class="line line-number-line">
						<code>29</code>
					</div>
									</div>
	</div>
<div class="diff-content">
			<div class="section top-missing">
												<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;return $errors;</code>
					</div>
																<div class="line diff-line ">
						<code>}</code>
					</div>
																<div class="line diff-line ">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line ">
						<code>/**</code>
					</div>
																<div class="line diff-line ">
						<code> * Retrieves a single post</code>
					</div>
																<div class="line diff-line ">
						<code> *</code>
					</div>
									</div>
	</div>
			</div>
		</div>	
				<div class="right side">
			<div class="inner-side">
				
<div class="line-numbers">
			<div class="line-numbers-section top-missing">
												<div class="line line-number-line">
						<code>24</code>
					</div>
																<div class="line line-number-line">
						<code>25</code>
					</div>
																<div class="line line-number-line">
						<code>26</code>
					</div>
																<div class="line line-number-line">
						<code>27</code>
					</div>
																<div class="line line-number-line">
						<code>28</code>
					</div>
																<div class="line line-number-line">
						<code>29</code>
					</div>
																<div class="line line-number-line">
						<code>30</code>
					</div>
																<div class="line line-number-line">
						<code>31</code>
					</div>
																<div class="line line-number-line">
						<code>32</code>
					</div>
																<div class="line line-number-line">
						<code>33</code>
					</div>
																<div class="line line-number-line">
						<code>34</code>
					</div>
																<div class="line line-number-line">
						<code>35</code>
					</div>
																<div class="line line-number-line">
						<code>36</code>
					</div>
																<div class="line line-number-line">
						<code>37</code>
					</div>
																<div class="line line-number-line">
						<code>38</code>
					</div>
																<div class="line line-number-line">
						<code>39</code>
					</div>
																<div class="line line-number-line">
						<code>40</code>
					</div>
																<div class="line line-number-line">
						<code>41</code>
					</div>
																<div class="line line-number-line">
						<code>42</code>
					</div>
																<div class="line line-number-line">
						<code>43</code>
					</div>
																<div class="line line-number-line">
						<code>44</code>
					</div>
																<div class="line line-number-line">
						<code>45</code>
					</div>
																<div class="line line-number-line">
						<code>46</code>
					</div>
																<div class="line line-number-line">
						<code>47</code>
					</div>
																<div class="line line-number-line">
						<code>48</code>
					</div>
																<div class="line line-number-line">
						<code>49</code>
					</div>
																<div class="line line-number-line">
						<code>50</code>
					</div>
																<div class="line line-number-line">
						<code>51</code>
					</div>
																<div class="line line-number-line">
						<code>52</code>
					</div>
																<div class="line line-number-line">
						<code>53</code>
					</div>
																<div class="line line-number-line">
						<code>54</code>
					</div>
																<div class="line line-number-line">
						<code>55</code>
					</div>
																<div class="line line-number-line">
						<code>56</code>
					</div>
																<div class="line line-number-line">
						<code>57</code>
					</div>
																<div class="line line-number-line">
						<code>58</code>
					</div>
																<div class="line line-number-line">
						<code>59</code>
					</div>
																<div class="line line-number-line">
						<code>60</code>
					</div>
																<div class="line line-number-line">
						<code>61</code>
					</div>
																<div class="line line-number-line">
						<code>62</code>
					</div>
																<div class="line line-number-line">
						<code>63</code>
					</div>
																<div class="line line-number-line">
						<code>64</code>
					</div>
									</div>
	</div>
<div class="diff-content">
			<div class="section top-missing">
												<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;return $errors;</code>
					</div>
																<div class="line diff-line ">
						<code>}</code>
					</div>
																<div class="line diff-line ">
						<code></code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>/**</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code> * Delete the specified comment on the specified post</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code> *</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code> * @param PDO $pdo</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code> * @param integer $postId</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code> * @param integer $commentId</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code> * @return boolean True if the command executed without errors</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code> * @throws Exception</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code> */</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>function deleteComment(PDO $pdo, $postId, $commentId)</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>{</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;// The comment id on its own would suffice, but post_id is a nice extra safety check</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;$sql = "</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE FROM</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;comment</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;post_id = :post_id</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND id = :comment_id</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;";</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;$stmt = $pdo-&gt;prepare($sql);</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;if ($stmt === false)</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;{</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw new Exception('There was a problem preparing this query');</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;}</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code></code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;$result = $stmt-&gt;execute(</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array(</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'post_id' =&gt; $postId,</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'comment_id' =&gt; $commentId,</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;);</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code></code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;return $result !== false;</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>}</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code></code>
					</div>
																<div class="line diff-line ">
						<code>/**</code>
					</div>
																<div class="line diff-line ">
						<code> * Retrieves a single post</code>
					</div>
																<div class="line diff-line ">
						<code> *</code>
					</div>
									</div>
	</div>
			</div>
		</div>
	</div>
				</div>
			</div>
		</div>
			<div id="tabs-a2fc91df29580763cd13-1" class="insert-diff" style="display: none;">
			<div class="top-bar">

				
				<div class="download-block">
					<span class="download">
						<a href="https://ilovephp.jondh.me.uk/checkouts/rebase5/a2fc91df29580763cd13/view-post.php" target="_blank"><img src="Make%20your%20own%20blog%20%3E%20Comment%20admin_files/disk.png" alt="">
						Download</a>
					</span>
				</div>

			</div>
			<div class="diff-scroll contracted">
				<div class="diff-body">
					<div class="file ">
			<div class="left side">
			<div class="inner-side">
				
<div class="line-numbers">
			<div class="line-numbers-section top-missing">
												<div class="line line-number-line">
						<code>28</code>
					</div>
																<div class="line line-number-line">
						<code>29</code>
					</div>
																<div class="line line-number-line">
						<code>30</code>
					</div>
																<div class="line line-number-line">
						<code>31</code>
					</div>
																<div class="line line-number-line">
						<code>32</code>
					</div>
																<div class="line line-number-line">
						<code>33</code>
					</div>
																<div class="line line-number-line">
						<code>34</code>
					</div>
																<div class="line line-number-line">
						<code>35</code>
					</div>
																<div class="line line-number-line">
						<code>36</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-line">
						<code>37</code>
					</div>
																<div class="line line-number-line">
						<code>38</code>
					</div>
																<div class="line line-number-line">
						<code>39</code>
					</div>
									</div>
	</div>
<div class="diff-content">
			<div class="section top-missing">
												<div class="line diff-line ">
						<code>$errors = null;</code>
					</div>
																<div class="line diff-line ">
						<code>if ($_POST)</code>
					</div>
																<div class="line diff-line ">
						<code>{</code>
					</div>
																<div class="line diff-line diff-line-deleted">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;$commentData = array(</code>
					</div>
																<div class="line diff-line diff-line-deleted">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'name' =&gt; $_POST['comment-name'],</code>
					</div>
																<div class="line diff-line diff-line-deleted">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'website' =&gt; $_POST['comment-website'],</code>
					</div>
																<div class="line diff-line diff-line-deleted">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'text' =&gt; $_POST['comment-text'],</code>
					</div>
																<div class="line diff-line diff-line-deleted">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;);</code>
					</div>
																<div class="line diff-line diff-line-deleted">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;$errors = handleAddComment($pdo, $postId, $commentData);</code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line ">
						<code>}</code>
					</div>
																<div class="line diff-line ">
						<code>else</code>
					</div>
																<div class="line diff-line ">
						<code>{</code>
					</div>
									</div>
	</div>
			</div>
		</div>	
				<div class="right side">
			<div class="inner-side">
				
<div class="line-numbers">
			<div class="line-numbers-section top-missing">
												<div class="line line-number-line">
						<code>28</code>
					</div>
																<div class="line line-number-line">
						<code>29</code>
					</div>
																<div class="line line-number-line">
						<code>30</code>
					</div>
																<div class="line line-number-line">
						<code>31</code>
					</div>
																<div class="line line-number-line">
						<code>32</code>
					</div>
																<div class="line line-number-line">
						<code>33</code>
					</div>
																<div class="line line-number-line">
						<code>34</code>
					</div>
																<div class="line line-number-line">
						<code>35</code>
					</div>
																<div class="line line-number-line">
						<code>36</code>
					</div>
																<div class="line line-number-line">
						<code>37</code>
					</div>
																<div class="line line-number-line">
						<code>38</code>
					</div>
																<div class="line line-number-line">
						<code>39</code>
					</div>
																<div class="line line-number-line">
						<code>40</code>
					</div>
																<div class="line line-number-line">
						<code>41</code>
					</div>
																<div class="line line-number-line">
						<code>42</code>
					</div>
																<div class="line line-number-line">
						<code>43</code>
					</div>
																<div class="line line-number-line">
						<code>44</code>
					</div>
																<div class="line line-number-line">
						<code>45</code>
					</div>
																<div class="line line-number-line">
						<code>46</code>
					</div>
																<div class="line line-number-line">
						<code>47</code>
					</div>
																<div class="line line-number-line">
						<code>48</code>
					</div>
																<div class="line line-number-line">
						<code>49</code>
					</div>
																<div class="line line-number-line">
						<code>50</code>
					</div>
																<div class="line line-number-line">
						<code>51</code>
					</div>
																<div class="line line-number-line">
						<code>52</code>
					</div>
																<div class="line line-number-line">
						<code>53</code>
					</div>
																<div class="line line-number-line">
						<code>54</code>
					</div>
																<div class="line line-number-line">
						<code>55</code>
					</div>
									</div>
	</div>
<div class="diff-content">
			<div class="section top-missing">
												<div class="line diff-line ">
						<code>$errors = null;</code>
					</div>
																<div class="line diff-line ">
						<code>if ($_POST)</code>
					</div>
																<div class="line diff-line ">
						<code>{</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;switch ($_GET['action'])</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;{</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case 'add-comment':</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$commentData = array(</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'name' =&gt; $_POST['comment-name'],</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'website' =&gt; $_POST['comment-website'],</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'text' =&gt; $_POST['comment-text'],</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$errors = handleAddComment($pdo, $postId, $commentData);</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case 'delete-comment':</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Don't do anything if the user is not authorised</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (isLoggedIn())</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$deleteResponse = $_POST['delete-comment'];</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$keys = array_keys($deleteResponse);</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$deleteCommentId = $keys[0];</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;deleteComment($pdo, $postId, $deleteCommentId);</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;redirectAndExit('view-post.php?post_id=' . $postId);</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;}</code>
					</div>
																<div class="line diff-line ">
						<code>}</code>
					</div>
																<div class="line diff-line ">
						<code>else</code>
					</div>
																<div class="line diff-line ">
						<code>{</code>
					</div>
									</div>
	</div>
			</div>
		</div>
	</div>
				</div>
			</div>
		</div>
	</div>

<p id="hash-143117228e" class="commentable">
	Finally, I noticed that the logic to add a comment is contained within a function, but the
	logic to delete one is still in the <code class="inline">switch()</code> block in
	<span class="filename">view-post.php</span>. The following change just tidies that up:
</p>


<div class="tab-container" id="tab-container-72d433d7416b5b76b089eb5e339b6a3bc02dac67" data-easytabs="true">
	
			<img class="expand-toggle icon" src="Make%20your%20own%20blog%20%3E%20Comment%20admin_files/code-expand.png" alt="Expand/contract code area">

		<img class="tabs-move-left tabs-move icon" src="Make%20your%20own%20blog%20%3E%20Comment%20admin_files/tab-left.png" alt="Select previous tab">

	<div class="tabs-chopper">

				<ul class="tabs">
							<li class="tab active">
										<a href="#tabs-f138d10911cce2a8c77a-0" class="active">lib/view-post.php</a>

										<span class="active">lib/view-post.php</span>
				</li>
							<li class="tab">
										<a href="#tabs-f138d10911cce2a8c77a-1">view-post.php</a>

										<span>view-post.php</span>
				</li>
					</ul>

	</div>

	<img class="tabs-move-right tabs-move icon" src="Make%20your%20own%20blog%20%3E%20Comment%20admin_files/tab-right.png" alt="Select next tab">

				<div id="tabs-f138d10911cce2a8c77a-0" class="insert-diff active" style="">
			<div class="top-bar">

				
				<div class="download-block">
					<span class="download">
						<a href="https://ilovephp.jondh.me.uk/checkouts/rebase5/f138d10911cce2a8c77a/lib/view-post.php" target="_blank"><img src="Make%20your%20own%20blog%20%3E%20Comment%20admin_files/disk.png" alt="">
						Download</a>
					</span>
				</div>

			</div>
			<div class="diff-scroll contracted">
				<div class="diff-body">
					<div class="file ">
			<div class="left side">
			<div class="inner-side">
				
<div class="line-numbers">
			<div class="line-numbers-section top-missing">
												<div class="line line-number-line">
						<code>24</code>
					</div>
																<div class="line line-number-line">
						<code>25</code>
					</div>
																<div class="line line-number-line">
						<code>26</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-line">
						<code>27</code>
					</div>
																<div class="line line-number-line">
						<code>28</code>
					</div>
																<div class="line line-number-line">
						<code>29</code>
					</div>
									</div>
	</div>
<div class="diff-content">
			<div class="section top-missing">
												<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;return $errors;</code>
					</div>
																<div class="line diff-line ">
						<code>}</code>
					</div>
																<div class="line diff-line ">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line ">
						<code>/**</code>
					</div>
																<div class="line diff-line ">
						<code> * Delete the specified comment on the specified post</code>
					</div>
																<div class="line diff-line ">
						<code> *</code>
					</div>
									</div>
	</div>
			</div>
		</div>	
				<div class="right side">
			<div class="inner-side">
				
<div class="line-numbers">
			<div class="line-numbers-section top-missing">
												<div class="line line-number-line">
						<code>24</code>
					</div>
																<div class="line line-number-line">
						<code>25</code>
					</div>
																<div class="line line-number-line">
						<code>26</code>
					</div>
																<div class="line line-number-line">
						<code>27</code>
					</div>
																<div class="line line-number-line">
						<code>28</code>
					</div>
																<div class="line line-number-line">
						<code>29</code>
					</div>
																<div class="line line-number-line">
						<code>30</code>
					</div>
																<div class="line line-number-line">
						<code>31</code>
					</div>
																<div class="line line-number-line">
						<code>32</code>
					</div>
																<div class="line line-number-line">
						<code>33</code>
					</div>
																<div class="line line-number-line">
						<code>34</code>
					</div>
																<div class="line line-number-line">
						<code>35</code>
					</div>
																<div class="line line-number-line">
						<code>36</code>
					</div>
																<div class="line line-number-line">
						<code>37</code>
					</div>
																<div class="line line-number-line">
						<code>38</code>
					</div>
																<div class="line line-number-line">
						<code>39</code>
					</div>
																<div class="line line-number-line">
						<code>40</code>
					</div>
																<div class="line line-number-line">
						<code>41</code>
					</div>
																<div class="line line-number-line">
						<code>42</code>
					</div>
																<div class="line line-number-line">
						<code>43</code>
					</div>
																<div class="line line-number-line">
						<code>44</code>
					</div>
																<div class="line line-number-line">
						<code>45</code>
					</div>
																<div class="line line-number-line">
						<code>46</code>
					</div>
																<div class="line line-number-line">
						<code>47</code>
					</div>
																<div class="line line-number-line">
						<code>48</code>
					</div>
																<div class="line line-number-line">
						<code>49</code>
					</div>
																<div class="line line-number-line">
						<code>50</code>
					</div>
																<div class="line line-number-line">
						<code>51</code>
					</div>
																<div class="line line-number-line">
						<code>52</code>
					</div>
																<div class="line line-number-line">
						<code>53</code>
					</div>
																<div class="line line-number-line">
						<code>54</code>
					</div>
																<div class="line line-number-line">
						<code>55</code>
					</div>
																<div class="line line-number-line">
						<code>56</code>
					</div>
																<div class="line line-number-line">
						<code>57</code>
					</div>
																<div class="line line-number-line">
						<code>58</code>
					</div>
																<div class="line line-number-line">
						<code>59</code>
					</div>
									</div>
	</div>
<div class="diff-content">
			<div class="section top-missing">
												<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;return $errors;</code>
					</div>
																<div class="line diff-line ">
						<code>}</code>
					</div>
																<div class="line diff-line ">
						<code></code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>/**</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code> * Called to handle the delete comment form, redirects afterwards</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code> *</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code> * The $deleteResponse array is expected to be in the form:</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code> *</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code> *	Array ( [6] =&gt; Delete )</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code> *</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code> * which comes directly from input elements of this form:</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code> *</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code> *	name="delete-comment[6]"</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code> *</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code> * @param PDO $pdo</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code> * @param integer $postId</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code> * @param array $deleteResponse</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code> */</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>function handleDeleteComment(PDO $pdo, $postId, array $deleteResponse)</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>{</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;if (isLoggedIn())</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;{</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$keys = array_keys($deleteResponse);</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$deleteCommentId = $keys[0];</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($deleteCommentId)</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;deleteComment($pdo, $postId, $deleteCommentId);</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code></code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;redirectAndExit('view-post.php?post_id=' . $postId);</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;}</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>}</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code></code>
					</div>
																<div class="line diff-line ">
						<code>/**</code>
					</div>
																<div class="line diff-line ">
						<code> * Delete the specified comment on the specified post</code>
					</div>
																<div class="line diff-line ">
						<code> *</code>
					</div>
									</div>
	</div>
			</div>
		</div>
	</div>
				</div>
			</div>
		</div>
			<div id="tabs-f138d10911cce2a8c77a-1" class="insert-diff" style="display: none;">
			<div class="top-bar">

				
				<div class="download-block">
					<span class="download">
						<a href="https://ilovephp.jondh.me.uk/checkouts/rebase5/f138d10911cce2a8c77a/view-post.php" target="_blank"><img src="Make%20your%20own%20blog%20%3E%20Comment%20admin_files/disk.png" alt="">
						Download</a>
					</span>
				</div>

			</div>
			<div class="diff-scroll contracted">
				<div class="diff-body">
					<div class="file ">
			<div class="left side">
			<div class="inner-side">
				
<div class="line-numbers">
			<div class="line-numbers-section top-missing">
												<div class="line line-number-line">
						<code>39</code>
					</div>
																<div class="line line-number-line">
						<code>40</code>
					</div>
																<div class="line line-number-line">
						<code>41</code>
					</div>
																<div class="line line-number-line">
						<code>42</code>
					</div>
																<div class="line line-number-line">
						<code>43</code>
					</div>
																<div class="line line-number-line">
						<code>44</code>
					</div>
																<div class="line line-number-line">
						<code>45</code>
					</div>
																<div class="line line-number-line">
						<code>46</code>
					</div>
																<div class="line line-number-line">
						<code>47</code>
					</div>
																<div class="line line-number-line">
						<code>48</code>
					</div>
																<div class="line line-number-line">
						<code>49</code>
					</div>
																<div class="line line-number-line">
						<code>50</code>
					</div>
																<div class="line line-number-line">
						<code>51</code>
					</div>
																<div class="line line-number-line">
						<code>52</code>
					</div>
																<div class="line line-number-line">
						<code>53</code>
					</div>
									</div>
	</div>
<div class="diff-content">
			<div class="section top-missing">
												<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$errors = handleAddComment($pdo, $postId, $commentData);</code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;</code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case 'delete-comment':</code>
					</div>
																<div class="line diff-line diff-line-deleted">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Don't do anything if the user is not authorised</code>
					</div>
																<div class="line diff-line diff-line-deleted">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (isLoggedIn())</code>
					</div>
																<div class="line diff-line diff-line-deleted">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</code>
					</div>
																<div class="line diff-line diff-line-deleted">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$deleteResponse = $_POST['delete-comment'];</code>
					</div>
																<div class="line diff-line diff-line-deleted">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$keys = array_keys($deleteResponse);</code>
					</div>
																<div class="line diff-line diff-line-deleted">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$deleteCommentId = $keys[0];</code>
					</div>
																<div class="line diff-line diff-line-deleted">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;deleteComment($pdo, $postId, $deleteCommentId);</code>
					</div>
																<div class="line diff-line diff-line-deleted">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;redirectAndExit('view-post.php?post_id=' . $postId);</code>
					</div>
																<div class="line diff-line diff-line-deleted">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;</code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;}</code>
					</div>
																<div class="line diff-line ">
						<code>}</code>
					</div>
									</div>
	</div>
			</div>
		</div>	
				<div class="right side">
			<div class="inner-side">
				
<div class="line-numbers">
			<div class="line-numbers-section top-missing">
												<div class="line line-number-line">
						<code>39</code>
					</div>
																<div class="line line-number-line">
						<code>40</code>
					</div>
																<div class="line line-number-line">
						<code>41</code>
					</div>
																<div class="line line-number-line">
						<code>42</code>
					</div>
																<div class="line line-number-line">
						<code>43</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-empty">
						<code>&nbsp;</code>
					</div>
																<div class="line line-number-line">
						<code>44</code>
					</div>
																<div class="line line-number-line">
						<code>45</code>
					</div>
																<div class="line line-number-line">
						<code>46</code>
					</div>
									</div>
	</div>
<div class="diff-content">
			<div class="section top-missing">
												<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$errors = handleAddComment($pdo, $postId, $commentData);</code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;</code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case 'delete-comment':</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$deleteResponse = $_POST['delete-comment'];</code>
					</div>
																<div class="line diff-line diff-line-added">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;handleDeleteComment($pdo, $postId, $deleteResponse);</code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line-empty">
						<code></code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;</code>
					</div>
																<div class="line diff-line ">
						<code>&nbsp;&nbsp;&nbsp;&nbsp;}</code>
					</div>
																<div class="line diff-line ">
						<code>}</code>
					</div>
									</div>
	</div>
			</div>
		</div>
	</div>
				</div>
			</div>
		</div>
	</div>

<p id="hash-d4a6a6860a" class="commentable">
	As ever, test everything to check it works, before we proceed to the final chapter!
</p>

							</div>
							
		<div id="footer">
			<a href="https://www.reddit.com/r/ilovephp">Support channel</a>
|
<a href="https://github.com/halfer/php-tutorial-text/issues">Bug reports</a>
|
<a href="https://blog.jondh.me.uk/2014/08/online-php-beginners-tutorial/">Related blog post</a>
|
<a href="https://www.reddit.com/r/webdev/comments/2iqps3/ive_written_a_phpsql_app_dev_tutorial_for/">Original announcement</a>
|
<a href="http://validator.w3.org/check/referer">Valid HTML5</a>
		</div>
			<script>
	  var _paq = _paq || [];
	  _paq.push(['trackPageView']);
	  _paq.push(['enableLinkTracking']);
	  (function() {
		var u="//analytics.jondh.me.uk/";
		_paq.push(['setTrackerUrl', u+'piwik.php']);
		_paq.push(['setSiteId', 1]);
		var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
		g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
	  })();
	</script>
	<noscript><p><img src="//analytics.jondh.me.uk/piwik.php?idsite=1" style="border:0;" alt="" /></p></noscript>
		
        <!-- env: live -->
	

</body></html>